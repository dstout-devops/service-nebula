{
	"name": "service-nebula",
    "build": {
		"context": "build",
        "dockerfile": "build/Dockerfile"
    },

	"features": {
		"ghcr.io/devcontainers/features/common-utils:2": {
			"installZsh": "true",
			"installOhMyZsh": "true",
			"installOhMyZshConfig": "true",
			"configureZshAsDefaultShell": "true"
		},
		"ghcr.io/devcontainers/features/docker-in-docker:2": {
			"moby": "false",
			"dockerDefaultAddressPool": "base=10.0.0.0/16,size=24"
		}
	},

	"mounts": [
		{
			"source": "service-nebula-registry-cache",
			"target": "/tmp/registry-cache",
			"type": "volume"
		}
	],
	"containerEnv": {
		"NODE_EXTRA_CA_CERTS": "/etc/ssl/certs/ca-certificates.crt"
	},
	"forwardPorts": [8080, 8443],
	"portsAttributes": {
		"8080": {
			"label": "Traefik HTTP",
			"onAutoForward": "silent"
		},
		"8443": {
			"label": "Traefik HTTPS",
			"onAutoForward": "silent"
		}
	},
	"postStartCommand": "chmod +x .devcontainer/build/*.sh && .devcontainer/build/postCreateCommand.sh",
	"customizations": {
		"vscode": {
			"extensions": [
				"hashicorp.terraform",
				"ms-kubernetes-tools.vscode-kubernetes-tools",
				"ms-vscode.vscode-json"
			]
		}
	}
}